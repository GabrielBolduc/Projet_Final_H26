<div class="admin-page">

  <header class="admin-top-bar">
    <button mat-stroked-button class="btn-new" [routerLink]="['/task',taskId,'affectations','new']">
      <mat-icon>add</mat-icon>
      Ajouter une affectation
    </button>

    <h1 class="header-title">Affectations</h1>
  </header>

  <main>

    <div class="affectation-list">

      @for (affectation of affectations(); track affectation.id) {

        <mat-card class="affectation-card">

          <mat-card-content class="card-layout">

            <div class="user-section">

              <mat-icon class="user-icon">person</mat-icon>

              <div>
                <div class="user-name">
                  {{ affectation.user.name }}
                </div>

                <div class="user-phone">
                  {{ affectation.user.phone_number }}
                </div>

              </div>

            </div>


            <div class="info-section">

              <div class="info-row">
                <mat-icon>assignment</mat-icon>

                {{ affectation.responsability }}
              </div>

              <div class="info-row">
                <mat-icon>schedule</mat-icon>
                start:
                {{ affectation.expected_start | date:'short' }}
              </div>

              <div class="info-row">
                <mat-icon>schedule</mat-icon>
                end:
                {{ affectation.expected_end | date:'short' }}
              </div>

            </div>


            <div class="action-section">

              <button mat-flat-button color="primary" class="btn-dash" [routerLink]="['/task',taskId,'affectations', affectation.id]">
                En savoir plus
              </button>
                <button class="icon-btn trash" (click)="handleClick(affectation.id!)" title="Supprimer">
                  <mat-icon>delete_outline</mat-icon>
                </button>
            </div>

          </mat-card-content>


        </mat-card>

      }

    </div>

  </main>

</div>